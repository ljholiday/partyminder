# AGENTS.md

## Overview

This repository contains the WordPress plugin **PartyMinder**, a modular, event-focused social network. The project is designed with an emphasis on clean structure, minimal styling, and reusable UI patterns. The plugin must work seamlessly across multiple WordPress themes and environments without introducing conflicts or bloating the codebase.

The following guidelines apply to **CSS usage**, **page layout**, **template architecture**, and **system tracking**.

---

## CSS Policy

### Goals

- Maintain a **minimal, semantically consistent** stylesheet
- Eliminate class name collisions with WordPress, themes, or other plugins
- Use a strict prefix convention: all CSS classes must begin with `.pm-`
- Avoid utility-first or atomic styling (e.g., `.p-4`, `.text-lg`) unless consistently applied through `.pm-*` classes
- Favor semantic class names representing components, not styles

### Current File

All refactored styles must live in:

assets/css/partyminder.css

A backup of the original Codex-generated stylesheet should be preserved separately as a reference (e.g., `assets/css/partyminder.codex.css`).

### Cleanup Rules

- Remove all class selectors that:
  - Do not begin with `.pm-`
  - Are numeric or unit-based (`.2s`, `.75rem`, `.php`, etc.)
- Deduplicate styles
- Collapse similar patterns into shared `.pm-` classes (e.g., `.pm-card`, `.pm-btn`, `.pm-section`)

### Template Synchronization

Any change to a class name in CSS must be reflected throughout:
- Block render templates
- PHP page render callbacks
- Shortcodes and injected content

To identify mismatches, compare:

comm -23   <(grep -rho 'class="[^"]*"' plugins/partyminder | sed -E 's/class="([^"]*)"/\1/' | tr ' ' '\n' | sort | uniq)   <(grep -o '^\.[a-zA-Z0-9_-]\+' assets/css/partyminder.css | sed 's/^\.//' | sort | uniq)

---

## Page Template Architecture

### Goals

- Reduce visual and structural duplication across frontend views
- Improve maintainability through page-level layout reuse
- Create a small, consistent set of templates and inject context-specific content into them

### Template Types

#### 1. **Main Page Template**
- For index-style pages that show lists or summaries
- Used for: `my-events`, `my-conversations`, `my-communities`, `all-events`, etc.
- Layout: Full width or centered column, standard header + content section

#### 2. **Two Column Page Template**
- For pages with sidebar navigation or metadata
- Used for: dashboards, settings, community admin views

#### 3. **Form Page Template**
- For interactive screens: creation/editing of events, communities, or profiles
- Used for: `create-event`, `edit-event`, `rsvp`, etc.

> Wherever possible, **event creation, viewing, and editing should share the same form page layout**, only differing by content injected or editable state.

### Benefits

- Smaller codebase
- Faster layout changes
- Visual consistency across flows
- Lower processing and rendering overhead

---

## Layout Injection Strategy

- Use internal routing and shortcode-generated content to inject dynamic content into static layout templates
- Avoid duplicating headers, wrappers, or layout columns in every page
- Compose pages using layout scaffolds + modular content blocks

---

## Database Tracking

To avoid future confusion or regression, maintain a snapshot of current database tables and schema definitions.

### Recommendation

Create a file:
docs/database-tables.md

With contents generated by:

wp db tables > docs/database-tables.md

Or use:

wp db query "SHOW CREATE TABLE wp_partyminder_events;" >> docs/database-tables.md

Repeat for all plugin-owned tables. Update this file manually when migrations or schema changes occur.

---

## Maintenance and Tooling

### CSS Verification (No Stylelint)

If stylelint cannot run locally, use this:

grep -o '^\.[a-zA-Z0-9_-]\+' assets/css/partyminder.css | grep -v '^\.pm-' | sort | uniq

This will identify any remaining unprefixed or invalid class selectors.

### Suggested CI Action

When ready, add a GitHub Action to:
- Check for unprefixed class selectors
- Prevent PRs that reintroduce `.card`, `.btn`, `.header`, etc.

---

## Summary

The PartyMinder plugin should:
- Use a **single semantic stylesheet** with scoped `.pm-` class names
- Rely on **3 master templates** for consistent layout
- Avoid duplicated visual patterns across pages
- Track schema changes and system evolution
- Favor simplicity, reuse, and maintainability
